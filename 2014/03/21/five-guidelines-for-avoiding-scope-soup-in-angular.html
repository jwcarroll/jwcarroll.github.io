<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="Scope Soup is when you build a tangled mess of Angular code that is completely coupled to $scope in really terrible ways. The unfortunate part is that you see a lot of examples like that. I've written code like that. But after a year and a half working on a massive Angular project, I can assure you there is a better way.">
    
    <meta name="author" content="Josh Carroll">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Google+ Authorship -->
    <link rel="author" href="https://www.google.com/+JoshCarrollW">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@jwcarroll">

    <title>5 Guidelines For Avoiding Scope Soup in Angular - Techno Fattie</title>

    <!-- Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/bootstrap-social.css" rel="stylesheet">

    <!-- Styles -->
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/pygments/syntax.css" rel="stylesheet">

    <!-- Loading bar -->
    <script src="/js/pace.min.js"></script>

    <!-- HTML5 shiv for IE8 support -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->

    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47962022-1', 'technofattie.com');
    ga('send', 'pageview');

</script>
    
  </head>

  <body itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="url" content="http://www.technofattie.com" />
    <meta itemprop="description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming." />
    <div id="secondary" class="col-sm-3 sidebar" style="display: none;">
      <aside>

        <div class="about" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <h4>About <span itemprop="name">Josh Carroll</span></h4>
          <p itemprop="description">Computer geek, husband, father, theologian. I rock out web sites. I work for <span itemprop="worksFor" itemscope itemtype="http://schema.org/Organization"><a href="http://www.wintellect.com/" itemprop="url"><span itemprop="name">Wintellect</span></a></span>.</p>
        </div>

        <div class="socialmedia">
          <h4>Connect</h4>
          <div class="socials-sidebar">
          
            <a class="btn btn-twitter" href="https://twitter.com/jwcarroll" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          
            <a class="btn btn-linkedin" href="https://www.linkedin.com/in/jwcarroll" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
          
            <a class="btn btn-google-plus" href="https://www.google.com/+JoshCarrollW/posts" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          
            <a class="btn btn-github" href="https://github.com/jwcarroll" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
          
          </div> <!-- /.socials-sidebar -->
        </div>
        
        <div class="tags">
          <h4>Tags</h4>
          <ul>
          
            <li>
              <a href="/tags/f%23.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">f#</span></a>
            </li>
          
            <li>
              <a href="/tags/dot-net.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dot-net</span></a>
            </li>
          
            <li>
              <a href="/tags/c%23.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">c#</span></a>
            </li>
          
            <li>
              <a href="/tags/data-sets.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">data-sets</span></a>
            </li>
          
            <li>
              <a href="/tags/commentary.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">commentary</span></a>
            </li>
          
            <li>
              <a href="/tags/qa.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">qa</span></a>
            </li>
          
            <li>
              <a href="/tags/tdd.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">tdd</span></a>
            </li>
          
            <li>
              <a href="/tags/unit-testing.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">unit-testing</span></a>
            </li>
          
            <li>
              <a href="/tags/security.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">security</span></a>
            </li>
          
            <li>
              <a href="/tags/wpf.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">wpf</span></a>
            </li>
          
            <li>
              <a href="/tags/validation.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">validation</span></a>
            </li>
          
            <li>
              <a href="/tags/programming.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">programming</span></a>
            </li>
          
            <li>
              <a href="/tags/sarcasm.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">sarcasm</span></a>
            </li>
          
            <li>
              <a href="/tags/stackoverflow.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">stackoverflow</span></a>
            </li>
          
            <li>
              <a href="/tags/dynamic.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dynamic</span></a>
            </li>
          
            <li>
              <a href="/tags/powershell.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">powershell</span></a>
            </li>
          
            <li>
              <a href="/tags/angular.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">angular</span></a>
            </li>
          
            <li>
              <a href="/tags/javascript.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">javascript</span></a>
            </li>
          
            <li>
              <a href="/tags/dependency-injection.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dependency-injection</span></a>
            </li>
          
            <li>
              <a href="/tags/humor.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">humor</span></a>
            </li>
          
            <li>
              <a href="/tags/jekyll.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">jekyll</span></a>
            </li>
          
            <li>
              <a href="/tags/github.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">github</span></a>
            </li>
          
            <li>
              <a href="/tags/bootstrap.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">bootstrap</span></a>
            </li>
          
            <li>
              <a href="/tags/introspection.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">introspection</span></a>
            </li>
          
            <li>
              <a href="/tags/ng-transform.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">ng-transform</span></a>
            </li>
          
          </ul>
        </div>
        
        <div class="sidebar-links">
         <h4><a href="/archives/">Archives</a></h4>
        </div>
        
        
        <div>
            <h4>You Might Also Like:</h4>
            
            <h5>
               <a href="/2011/02/11/wpf-fancy-winforms.html">WPF != Fancy Winforms</a>
            </h5>
            
            <h5>
               <a href="/2010/06/25/extending-moq-using-extension-methods.html">Extending Moq Using Extension Methods</a>
            </h5>
            
            <h5>
               <a href="/2011/09/23/solving-ayende%27s-tax-woes.html">Solving Ayende's Tax Woes</a>
            </h5>
            
            <h5>
               <a href="/2014/02/15/angular-powered-text-transformations.html">Angular Powered Text Transformations - Part 1</a>
            </h5>
            
            <h5>
               <a href="/2014/02/11/slaying-the-dragons-of-self-defeat.html">Slaying The Dragons of Self Defeat</a>
            </h5>
            
        </div>
        
        
      </aside>
    </div> <!-- /#secondary -->

    <div id="primary" class="col-sm-12">
      <div class="content">
        
        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              <a rel="home" title="Techno Fattie" href="/">
                <i class="fa fa-code"></i> <span itemprop="name">Techno Fattie</span>
              </a>
            </h1>            
          </hgroup>
          <div id="togglesidebar" class="btn btn-primary pull-right">
            <i class="fa fa-bars"></i>
          </div>
        </header> <!-- /header -->

        

<section class="post" itemscope itemtype="http://schema.org/BlogPosting">
 <header class="entry-header">
   <img class="entry-avatar" alt="Josh Carroll" height="52" width="52" src="http://www.gravatar.com/avatar/213ff080fa03648f0b71e4f4658a8046.png?s=52">
   <h1 class="entry-title"><a href="/2014/03/21/five-guidelines-for-avoiding-scope-soup-in-angular.html" itemprop="url"><span itemprop="name">5 Guidelines For Avoiding Scope Soup in Angular</span></a></h1>
   <p class="entry-meta">
     Posted on <a class="entry-date" href="/archives/#march-2014"><time itemprop="dateCreated" datetime="2014-03-21T00:00:00-04:00">21 March 2014</time></a> |
     By <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a itemprop="url" class="entry-author" href="/about/"><span itemprop="name">Josh Carroll</span></a></span>
     
     | Tags 
     
     <a href="/tags/angular.html" class="btn btn-default btn-xs"><span itemprop="keywords">angular</span></a>
     
     <a href="/tags/javascript.html" class="btn btn-default btn-xs"><span itemprop="keywords">javascript</span></a>
     
     <a href="/tags/stackoverflow.html" class="btn btn-default btn-xs"><span itemprop="keywords">stackoverflow</span></a>
     
     
   </p>
 </header>
 <div class="entry-description" itemprop="articleBody">
   <h3>Today I was answering a question on Stackoverflow about Angular.js</h3>

<p>The more I dug into this person&#39;s particular problem the more help I realized they needed. They were admittedly an
Angular noob, but making a pretty decent effort by getting their hands dirty. A+ for effort.</p>

<p>I ended up completely refactoring their code, but <strong><a href="http://wintellect.com/html5-javascript-experts-angular-consultants">I see these same kinds of problems</a> over and over again so I decided
to compile some of these guidelines into a blog post for future reference.</strong></p>

<p>If you are impatient, here is the <a href="http://plnkr.co/edit/0aYg1TbnRFwW1WhuPKYp?p=preview">original code</a>,
and here is the <a href="http://plnkr.co/edit/6R3zEX?p=preview">refactored version</a>.</p>

<p>The code is full of what I call <span class="keyword">scope soup</span>. <strong>What is Scope Soup you ask?</strong></p>

<p>This is...</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="p">[])</span>
<span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">){</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">tagSearch</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">tags</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">$scope</span><span class="p">.</span><span class="nx">getTags</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/tags/?search=&#39;</span> <span class="o">+</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">tagSearch</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">tags</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;tagSearch&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">getTags</span><span class="p">();</span>
  <span class="p">});</span>

  <span class="c1">// 1000 more lines of this mess</span>

<span class="p">});</span>
</code></pre></div>

<p>AAAAHHHHHH!!!! Somebody save me from the madness!</p>

<p><strong><span class="keyword">Scope Soup</span> is when you build a tangled mess of Angular code that is completely
coupled to <code>$scope</code> in really terrible ways.</strong> The unfortunate part is that you see a lot of examples like that.
I&#39;ve written code like that. But after a year and a half working on a <a href="http://wintellect.com/html5-javascript-experts-angular-consultants">massive Angular project</a>,
I can assure you there is a better way.</p>

<p><strong>So without further ado, here are my <span class="keyword">five guidelines for avoiding Scope Soup in Angular.</span></strong></p>

<h3>1. Controllers Should Be Classes</h3>

<p>Angular makes it really easy to add an inline controller as an anonymous function, <strong>but just because you can doesn&#39;t
mean you should.</strong> Inline functions encourage you to shove everything into <code>$scope</code>, but defining your controller as a class
and using the prototype to add functionality helps to keep you honest.</p>

<p>** <strong>Update</strong> **
<em>A colleage of mine, correctly pointed out that the <code>this</code> pointer was refering to <code>$scope</code> instead of the controller.
I forgot to pull out a reference to the controller using a closure. You could also do this using the <code>.bind()</code> method.</em></p>

<div class="highlight"><pre><code class="javascript"><span class="c1">//Don&#39;t do this</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">doStuff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//Really long function body</span>
  <span class="p">};</span>
<span class="p">});</span>


<span class="c1">//Do this instead</span>
<span class="kd">var</span> <span class="nx">MyCtrl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

  <span class="nx">$scope</span><span class="p">.</span><span class="nx">doStuff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">_this</span><span class="p">.</span><span class="nx">doStuff</span><span class="p">();</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="nx">MyCtrl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">doStuff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="c1">//Really long function body</span>
<span class="p">};</span>

<span class="nx">MyCtrl</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">];</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="nx">MyCtrl</span><span class="p">);</span>
</code></pre></div>

<p>Defining your controllers in this way makes you think a little harder about just hanging everything off of <code>$scope</code>. Aside
from that, if your controller has more than a couple of methods, tracing the code through well defined methods is a lot
easier than trying to sift through a mess of <span class="keyword">Scope Soup</span>.</p>

<h3>2. Keep Controllers Skinny With Services</h3>

<p>Rest services are usually pretty simple, so it can be tempting to just use <code>$http</code> to get what you need right in
your controller. However, <strong>it&#39;s much better to encapsulate those calls into a service.</strong></p>

<div class="highlight"><pre><code class="javascript"><span class="c1">//Don&#39;t do this</span>
<span class="c1">// ng-click=&#39;getDetail()&#39;</span>
<span class="nx">$scope</span><span class="p">.</span><span class="nx">getDetail</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/item/detail/&#39;</span> <span class="o">+</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">selectedItem</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">detail</span><span class="p">){</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">itemDetail</span> <span class="o">=</span> <span class="nx">detail</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="c1">//Do this instead</span>
<span class="c1">// ng-click=&#39;getDetail(item)&#39;</span>
<span class="nx">MyCtrl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDetail</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">itemService</span><span class="p">.</span><span class="nx">getDetail</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">detail</span><span class="p">){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">detail</span> <span class="o">=</span> <span class="nx">detail</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div>

<p>Again, doing this will make your code easier to understand. Not only that but it will be much easier to test
since you can mock the service and inject it into your controller. <strong>It helps you to avoid <span class="keyword">Scope Soup</span>
because you have to decouple your data services from your controller.</strong></p>

<p>Pulling out data access into a service will also allow you to reuse that same code within
directives, filters, other controllers, and other services.</p>

<h3>3. Eliminate Scope Using The &#39;Controller As&#39; Syntax</h3>

<p>Angular 1.2 introduced the ability to publish your entire controller to <code>$scope</code> using the <a href="http://docs.angularjs.org/api/ng/directive/ngController">&quot;Controller As&quot;</a>
syntax. Using this you can <strong>completely eliminate the need to reference <code>$scope</code> in your controller.</strong></p>

<p>The syntax is pretty simple as well.</p>

<div class="highlight"><pre><code class="html"><span class="c">&lt;!-- In Your Binding --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&quot;MyCtrl as ctrl&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;span&gt;&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>

//In your route
$routeProvider
.when(&#39;/&#39;,{
  templateUrl: &#39;foo.html&#39;,
  controller: &#39;MyCtrl&#39;,
  controllerAs: &#39;ctrl&#39;
});
</code></pre></div>

<p>A controller should be pretty self contained, and <strong>this technique will also keep you honest and less likely to
rely on properties being set in the parent scope</strong> which can lead to difficult to maintain code, and hard to track down bugs.</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">//Don&#39;t do this</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;Techno Fattie&#39;</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">//Do this</span>
<span class="kd">var</span> <span class="nx">MyCtrl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;Techno Fattie&#39;</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="nx">MyCtrl</span><span class="p">);</span>
</code></pre></div>

<h3>4. Eliminate Watches Using &#39;ng-change&#39; And ES5 Properties</h3>

<p>Getting rid of <code>$scope</code> completely might seem impossible if you are using explicit watches in your controllers, but in
most cases you shouldn&#39;t need them.</p>

<p><strong>If you have a watch set up to listen for a property change that originates from a form field, then <a href="http://docs.angularjs.org/api/ng/directive/ngChange">ng-change</a>
is your best bet.</strong> It&#39;s important to note however, that ng-change requires ng-model, and does not fire a change event if the change
originates from the controller. That being said, this is a pretty common scenario where I see people use a <code>$watch</code> instead
of just using ng-change.</p>

<div class="highlight"><pre><code class="html">//Don&#39;t do this
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span>

app.controller(&#39;MyCtrl&#39;, function($scope){
  $scope.$watch(&#39;name&#39;, function(){
    //call some service here
  });
});

//Do this
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;ctrl.name&quot;</span> <span class="na">ng-change=</span><span class="s">&quot;ctrl.search(ctrl.name)&quot;</span> <span class="nt">/&gt;</span>

MyCtrl.prototype.search = function(name){
  //call some service here
};
</code></pre></div>

<p>If you have some property that isn&#39;t bound to an input field, or is going to be updated from code, it may seem like
a watch is your only choice. However, if you don&#39;t have to support IE8 or lower, then <strong>you can take advantage of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">ES5
properties</a> to trigger functionality when something changes on your controller.</strong></p>

<div class="highlight"><pre><code class="javascript"><span class="c1">//Don&#39;t do this</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;selectedItem&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//call some service here</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="c1">//Do this instead</span>
<span class="kd">var</span> <span class="nx">MyCtrl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_selectedItem</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>

<span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">MyCtrl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
    <span class="s2">&quot;selectedItem&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selectedItem</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_selectedItem</span> <span class="o">=</span> <span class="nx">newValue</span><span class="p">;</span>

        <span class="c1">//Call method on update</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">onSelectedItemChange</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_selectedItem</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</code></pre></div>

<p>This might seem a bit verbose, but it does help you avoid <span class="keyword">Scope Soup</span> by eliminating your
need to use a <code>$watch</code>. Your controller is a little easier to test with one less dependency and it&#39;s a lot more reusable.</p>

<h3>5. Don&#39;t Use Scope To Pass Data Around</h3>

<p>Scope can be a convenient way to pass data between two controllers, it might even feel a little ninja, but <strong>it will
almost always end in tears and heavy drinking.</strong></p>

<p>The problem with relying on values to be set from a parent controller, or relying on a child controller to set data
back up on the parent scope, is that you <strong>end up with an implicit coupling that isn&#39;t easy to see at first.</strong> If I&#39;m looking
at my controller and see some random property being used, but it&#39;s never set, and doesn&#39;t exist in my view, then I have to
go hunting around to find out where it came from.</p>

<p>Worse, it means <strong>the controller implementation is completely dependent on the ordering of the bindings in the view!</strong>
I can&#39;t use or test those controllers independently of each other, because they are coupled together by <code>$scope</code>.</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">//Don&#39;t do this</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;Parent&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">sharedObj</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">someProperty</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span>
  <span class="p">};</span>

  <span class="nx">$scope</span><span class="p">.</span><span class="nx">sharedObj</span> <span class="o">=</span> <span class="nx">sharedObj</span><span class="p">;</span>

  <span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;sharedObj.someProperty&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//call some service here</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">&quot;Child&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;sharedObj.name&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">myName</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">sharedObj</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">});</span>


<span class="c1">//Do this instead</span>
<span class="kd">var</span> <span class="nx">Parent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sharedDataService</span><span class="p">){</span>
  <span class="nx">sharedDataService</span><span class="p">.</span><span class="nx">updateName</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Child</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">messageService</span><span class="p">){</span>
  <span class="nx">sharedDataService</span><span class="p">.</span><span class="nx">onNameChanged</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nameChangedHandler</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">nameChangedHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">myName</span> <span class="o">=</span> <span class="nx">sharedDataService</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div>

<p>Using a messaging paradigm to communicate between controllers will help you keep things clean, decoupled, and testable.
<strong>It helps you to avoid <span class="keyword">Scope Soup</span> because you aren&#39;t using <code>$scope</code> like a peeping tom...
taking advantage of your position and knowledge in order to do something you know you probably shouldn&#39;t.</strong></p>

<p>Some of you might be objecting right now that I could have done the same thing by using <code>$emit</code> and <code>$broadcast</code> to accomplish
the same thing, but <strong>I prefer to keep those details hidden for the same reason I keep <code>$http</code> hidden behind a service layer.</strong>
It also means I am not dependent on having a particular parent-child relationship configured in order to make this work.
Another advantage is that my service could be doing a lot more stuff under the hood if needed. It could be calling a
web service, or pushing out a message using Web Sockets, but the code in my controllers won&#39;t have to change.</p>

<h3>Conclusion</h3>

<p>Angular&#39;s Scope is the magic glue that makes everything work together, but it is easily abused. It is better kept behind
the scenes doing the hard work of keeping your UI in sync with your underlying model. With a little bit of work, you can
completely eliminate the need to litter your code with <code>$scope</code>.</p>

<p><strong>Stop Making Scope Soup!</strong></p>

<p>In the end you will have a much more testable, and maintainable application.</p>

 </div>
 

<div class="footer">
    <h4>Share This Post</h4>

    <div class="socials-footer">
        <a class="btn btn-twitter" href="http://twitter.com/share?text=5 Guidelines For Avoiding Scope Soup in Angular by @jwcarroll&url=http://www.technofattie.com/2014/03/21/five-guidelines-for-avoiding-scope-soup-in-angular.html" rel="nofollow"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="btn btn-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.technofattie.com/2014/03/21/five-guidelines-for-avoiding-scope-soup-in-angular.html" rel="nofollow"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fa fa-facebook"></i>
        </a>
        <a class="btn btn-google-plus" href="https://plus.google.com/share?url=http://www.technofattie.com/2014/03/21/five-guidelines-for-avoiding-scope-soup-in-angular.html" rel="nofollow"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
            <i class="fa fa-google-plus"></i>
        </a>
    </div>
</div>
</section>

<div class="comments">
 <div id="disqus_thread"></div>
 <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'technofattie'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

        <footer class="footer">
          <p itemprop="author" itemscope itemtype="http://schema.org/Person">© <a href="/about/" itemprop="url"><span itemprop="name">Josh Carroll</span></a> 2014. All right reserved.</p>
          <div class="socials-footer">
          
            <a class="btn btn-twitter" href="https://twitter.com/jwcarroll" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          
            <a class="btn btn-linkedin" href="https://www.linkedin.com/in/jwcarroll" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
          
            <a class="btn btn-google-plus" href="https://www.google.com/+JoshCarrollW/posts" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          
            <a class="btn btn-github" href="https://github.com/jwcarroll" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
          
          </div> <!-- /.socials-footer -->
        </footer> <!-- /footer -->

      </div>
    </div> <!-- /#primary -->

    <!-- Scripts -->
    <script src="/js/jquery-1.11.0.min.js"></script>
    <script src="/js/custom.js"></script>

  </body>
</html>