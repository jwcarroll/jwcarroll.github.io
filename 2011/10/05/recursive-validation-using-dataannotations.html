<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming.">
    
    <meta name="author" content="Josh Carroll">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Google+ Authorship -->
    <link rel="author" href="https://www.google.com/+JoshCarrollW">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@jwcarroll">
    
    
    <meta name="twitter:description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming.">
    
    <meta name="twitter:title" content="Recursive Validation Using DataAnnotations - Techno Fattie">

    <title>Recursive Validation Using DataAnnotations - Techno Fattie</title>

    <!-- Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/bootstrap-social.css" rel="stylesheet">

    <!-- Styles -->
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/pygments/syntax.css" rel="stylesheet">

    <!-- HTML5 shiv for IE8 support -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->

    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47962022-1', 'technofattie.com');
    ga('require', 'displayfeatures');
    ga('require', 'linkid', 'linkid.js');
    ga('send', 'pageview');

</script>
    
  </head>

  <body itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="url" content="http://www.technofattie.com" />
    <meta itemprop="description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming." />
    <div id="secondary" class="col-sm-3 sidebar" style="display: none;">
      <aside>

        <div class="about" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <h4>About <span itemprop="name">Josh Carroll</span></h4>
          <p itemprop="description">Computer geek, husband, father, theologian. I rock out web sites. I work for <span itemprop="worksFor" itemscope itemtype="http://schema.org/Organization"><a href="http://www.wintellect.com/" itemprop="url"><span itemprop="name">Wintellect</span></a></span>.</p>
        </div>

        <div class="socialmedia">
          <h4>Connect</h4>
          <div class="socials-sidebar">
          
            <a class="btn btn-twitter" href="https://twitter.com/jwcarroll" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          
            <a class="btn btn-linkedin" href="https://www.linkedin.com/in/jwcarroll" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
          
            <a class="btn btn-google-plus" href="https://www.google.com/+JoshCarrollW/posts" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          
            <a class="btn btn-github" href="https://github.com/jwcarroll" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
          
            <a class="btn btn-rss" href="/rss.xml" title="RSS">
              <i class="fa fa-rss"></i>
            </a>
          
          </div> <!-- /.socials-sidebar -->
        </div>
        
        <div class="tags">
          <h4>Tags</h4>
          <ul>
          
            <li>
              <a href="/tags/f%23.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">f#</span></a>
            </li>
          
            <li>
              <a href="/tags/dot-net.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dot-net</span></a>
            </li>
          
            <li>
              <a href="/tags/c%23.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">c#</span></a>
            </li>
          
            <li>
              <a href="/tags/data-sets.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">data-sets</span></a>
            </li>
          
            <li>
              <a href="/tags/commentary.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">commentary</span></a>
            </li>
          
            <li>
              <a href="/tags/qa.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">qa</span></a>
            </li>
          
            <li>
              <a href="/tags/tdd.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">tdd</span></a>
            </li>
          
            <li>
              <a href="/tags/unit-testing.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">unit-testing</span></a>
            </li>
          
            <li>
              <a href="/tags/security.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">security</span></a>
            </li>
          
            <li>
              <a href="/tags/wpf.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">wpf</span></a>
            </li>
          
            <li>
              <a href="/tags/validation.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">validation</span></a>
            </li>
          
            <li>
              <a href="/tags/programming.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">programming</span></a>
            </li>
          
            <li>
              <a href="/tags/sarcasm.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">sarcasm</span></a>
            </li>
          
            <li>
              <a href="/tags/stackoverflow.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">stackoverflow</span></a>
            </li>
          
            <li>
              <a href="/tags/dynamic.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dynamic</span></a>
            </li>
          
            <li>
              <a href="/tags/powershell.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">powershell</span></a>
            </li>
          
            <li>
              <a href="/tags/angular.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">angular</span></a>
            </li>
          
            <li>
              <a href="/tags/javascript.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">javascript</span></a>
            </li>
          
            <li>
              <a href="/tags/dependency-injection.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dependency-injection</span></a>
            </li>
          
            <li>
              <a href="/tags/humor.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">humor</span></a>
            </li>
          
            <li>
              <a href="/tags/jekyll.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">jekyll</span></a>
            </li>
          
            <li>
              <a href="/tags/github.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">github</span></a>
            </li>
          
            <li>
              <a href="/tags/bootstrap.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">bootstrap</span></a>
            </li>
          
            <li>
              <a href="/tags/introspection.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">introspection</span></a>
            </li>
          
            <li>
              <a href="/tags/ng-transform.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">ng-transform</span></a>
            </li>
          
            <li>
              <a href="/tags/directives.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">directives</span></a>
            </li>
          
            <li>
              <a href="/tags/angular-tips.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">angular-tips</span></a>
            </li>
          
            <li>
              <a href="/tags/controller-as.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">controller-as</span></a>
            </li>
          
            <li>
              <a href="/tags/routing.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">routing</span></a>
            </li>
          
            <li>
              <a href="/tags/interviews.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">interviews</span></a>
            </li>
          
            <li>
              <a href="/tags/angular-modules.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">angular-modules</span></a>
            </li>
          
            <li>
              <a href="/tags/bootstrapping.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">bootstrapping</span></a>
            </li>
          
            <li>
              <a href="/tags/controllers.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">controllers</span></a>
            </li>
          
          </ul>
        </div>
        
        <div class="sidebar-links">
         <h4><a href="/archives/">Archives</a></h4>
        </div>
        
        
        <div>
            <h4>You Might Also Like:</h4>
            
            <h5>
               <a href="/2011/09/23/solving-ayende%27s-tax-woes.html">Solving Ayende's Tax Woes</a>
            </h5>
            
            <h5>
               <a href="/2011/02/11/wpf-fancy-winforms.html">WPF != Fancy Winforms</a>
            </h5>
            
            <h5>
               <a href="/2012/04/21/validating-read-the-source-luke.html">Validating "Read the Source, Luke"</a>
            </h5>
            
            <h5>
               <a href="/2011/02/09/unit-testing-and-declarative-security-part-1.html">Unit Testing and Declarative Security, Part 1</a>
            </h5>
            
            <h5>
               <a href="/2014/03/21/five-guidelines-for-avoiding-scope-soup-in-angular.html">5 Guidelines For Avoiding Scope Soup in Angular</a>
            </h5>
            
        </div>
        
        
      </aside>
    </div> <!-- /#secondary -->

    <div id="primary" class="col-sm-12">
      <div class="content">
        
        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              <a rel="home" title="Techno Fattie" href="/">
                <i class="fa fa-code"></i> <span itemprop="name">Techno Fattie</span>
              </a>
            </h1>            
          </hgroup>
          <div id="togglesidebar" class="btn btn-primary pull-right">
            <i class="fa fa-bars"></i>
          </div>
        </header> <!-- /header -->

        

<section class="post" itemscope itemtype="http://schema.org/BlogPosting">
 <header class="entry-header">
   <img class="entry-avatar" alt="Josh Carroll" height="52" width="52" src="http://www.gravatar.com/avatar/213ff080fa03648f0b71e4f4658a8046.png?s=52">
   <h1 class="entry-title"><a href="/2011/10/05/recursive-validation-using-dataannotations.html" itemprop="url"><span itemprop="name">Recursive Validation Using DataAnnotations</span></a></h1>
   <p class="entry-meta">
     Posted on <a class="entry-date" href="/archives/#october-2011"><time itemprop="dateCreated" datetime="2011-10-05T00:00:00-04:00">05 October 2011</time></a> |
     By <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a itemprop="url" class="entry-author" href="/about/"><span itemprop="name">Josh Carroll</span></a></span>
     
     | Tags 
     
     <a href="/tags/c%23.html" class="btn btn-default btn-xs"><span itemprop="keywords">c#</span></a>
     
     <a href="/tags/dot-net.html" class="btn btn-default btn-xs"><span itemprop="keywords">dot-net</span></a>
     
     <a href="/tags/validation.html" class="btn btn-default btn-xs"><span itemprop="keywords">validation</span></a>
     
     
   </p>
 </header>
 <div class="entry-description" itemprop="articleBody">
   <p>I saw a <a href="http://stackoverflow.com/questions/7663501/dataannotations-recursively-validating-an-entire-object-graph">post on Stackoverflow</a> today that piqued my interest.</p>

<p>The title really says it all:</p>

<p><span class="Apple-style-span" style="background-color: white; font-family: 'Trebuchet MS', 'Liberation Sans', 'DejaVu Sans', sans-serif; line-height: 12px;"></span>
<h1 style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: 'Trebuchet MS', 'Liberation Sans', 'DejaVu Sans', sans-serif; font-weight: bold; margin-bottom: 7px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;"> <span class="Apple-style-span" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: black; cursor: pointer; font-size: small; font-weight: bold; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; text-decoration: none; vertical-align: baseline;"><a class="question-hyperlink" href="http://stackoverflow.com/questions/7663501/dataannotations-recursively-validating-an-entire-object-graph" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: black; cursor: pointer; font-weight: bold; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; text-decoration: none; vertical-align: baseline;">DataAnnotations: Recursively validating an entire object graph</a></span></h1>
Using the DataAnnotations to do validation on object can be extermely useful, but there are many limitations to the existing code base. One such limitations, as <a href="http://stackoverflow.com/users/26414/neil-barnwell">Neil </a>has discovered, is that the out of the box validator doesn&#39;t recursively apply validation.</p>

<p>Indeed looking at the MSDN docs for <a href="http://msdn.microsoft.com/en-us/library/dd411772.aspx">TryValidateObject</a> state clearly that:
<blockquote><span class="Apple-style-span" style="font-family: 'Segoe UI', Verdana, Arial; font-size: 13px;">This method evaluates each&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.validationattribute.aspx" style="color: #1364c4; text-decoration: none;">ValidationAttribute</a>&nbsp;instance that is attached to the object type. It also checks whether each property that is marked with&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.requiredattribute.aspx" style="color: #1364c4; text-decoration: none;">RequiredAttribute</a>&nbsp;is provided.<span class="Apple-style-span" style="background-color: yellow;"> It does not recursively validate</span> the property values of the object.</span></blockquote>&nbsp;So how do we get around this? Well... there are several examples of people using reflection and LINQ to recurse over the individual properties and validate each one of them. Yuck!</p>

<p><b>I&#39;m a big fan of working with the framework</b> if at all possible, so I decided to implement a quick solution that fits nicely into the DataAnnotations world.</p>

<p>The idea is to simply tell the validation framework that you would like to do a little extra with some particular property. I want to be able to be able to <i>opt in</i> certain properties to further validation if necessary. Something like this.</p>

<div class="highlight"><pre><code class="c#"><span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
<span class="na">  [Required]</span>
  <span class="k">public</span> <span class="n">String</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">  [Required, ValidateObject]</span>
  <span class="k">public</span> <span class="n">Address</span> <span class="n">Address</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Address could have it&#39;s own set of validation attributes, and I want to also validate those along with my Person type. <b>Turns out this is pretty simple to do using existing framework components.</b></p>

<p>Let me just show you the code, and then I can explain what is going on.</p>

<div class="highlight"><pre><code class="c#"><span class="k">public</span> <span class="k">class</span> <span class="nc">ValidateObjectAttribute</span><span class="p">:</span> <span class="n">ValidationAttribute</span> <span class="p">{</span>
   <span class="k">protected</span> <span class="k">override</span> <span class="n">ValidationResult</span> <span class="nf">IsValid</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">,</span> <span class="n">ValidationContext</span> <span class="n">validationContext</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">var</span> <span class="n">results</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;();</span>
      <span class="kt">var</span> <span class="n">context</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ValidationContext</span><span class="p">(</span><span class="k">value</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>

      <span class="n">Validator</span><span class="p">.</span><span class="n">TryValidateObject</span><span class="p">(</span><span class="k">value</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">.</span><span class="n">Count</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
         <span class="kt">var</span> <span class="n">compositeResults</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CompositeValidationResult</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;Validation for {0} failed!&quot;</span><span class="p">,</span> <span class="n">validationContext</span><span class="p">.</span><span class="n">DisplayName</span><span class="p">));</span>
         <span class="n">results</span><span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">compositeResults</span><span class="p">.</span><span class="n">AddResult</span><span class="p">);</span>

         <span class="k">return</span> <span class="n">compositeResults</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">.</span><span class="n">Success</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CompositeValidationResult</span><span class="p">:</span> <span class="n">ValidationResult</span> <span class="p">{</span>
   <span class="k">private</span> <span class="k">readonly</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;</span> <span class="n">_results</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;();</span>

   <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;</span> <span class="n">Results</span> <span class="p">{</span>
      <span class="k">get</span> <span class="p">{</span>
         <span class="k">return</span> <span class="n">_results</span><span class="p">;</span>
      <span class="p">}</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="nf">CompositeValidationResult</span><span class="p">(</span><span class="kt">string</span> <span class="n">errorMessage</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">)</span> <span class="p">{}</span>
   <span class="k">public</span> <span class="nf">CompositeValidationResult</span><span class="p">(</span><span class="kt">string</span> <span class="n">errorMessage</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">memberNames</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">,</span> <span class="n">memberNames</span><span class="p">)</span> <span class="p">{}</span>
   <span class="k">protected</span> <span class="nf">CompositeValidationResult</span><span class="p">(</span><span class="n">ValidationResult</span> <span class="n">validationResult</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">validationResult</span><span class="p">)</span> <span class="p">{}</span>

   <span class="k">public</span> <span class="k">void</span> <span class="nf">AddResult</span><span class="p">(</span><span class="n">ValidationResult</span> <span class="n">validationResult</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">_results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">validationResult</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The idea here is pretty simple. Any property decorated with the ValidateObjectAttribute will be validated as a whole, and the results aggregated together. The processing is as follows: </p>

<ol>
<li>Create a new ValidationContext using the current value as the target</li>
<li>Attempt to validate that object, being sure to include all properties</li>
<li>If there are any ValidationResults, store them and return as a single aggregate failure</li>
<li>If there are no results, return ValidationResults.Success</li>
</ol>

<p>Putting it all together, imagine for a minute that we had the following class structure:</p>

<div class="highlight"><pre><code class="c#"><span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
<span class="na">  [Required]</span>
  <span class="k">public</span> <span class="n">String</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">  [Required, ValidateObject]</span>
  <span class="k">public</span> <span class="n">Address</span> <span class="n">Address</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Address</span> <span class="p">{</span>
<span class="na">  [Required]</span>
  <span class="k">public</span> <span class="n">String</span> <span class="n">Street1</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

  <span class="k">public</span> <span class="n">String</span> <span class="n">Street2</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">  [Required]</span>
  <span class="k">public</span> <span class="n">String</span> <span class="n">City</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">  [Required]</span>
  <span class="k">public</span> <span class="n">String</span> <span class="n">State</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">  [Required, ValidateObject]</span>
  <span class="k">public</span> <span class="n">ZipCode</span> <span class="n">Zip</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">ZipCode</span> <span class="p">{</span>
<span class="na">  [Required]</span>
  <span class="k">public</span> <span class="n">String</span> <span class="n">PrimaryCode</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

  <span class="k">public</span> <span class="n">String</span> <span class="n">SubCode</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>We can simply make use of existing methods and validate the entire object graph. Also, making use of our CompositeValidationResult, we should be able to drill into each individual failure in context.</p>

<div class="highlight"><pre><code class="c#"><span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
   <span class="kt">var</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span> <span class="p">{</span>
      <span class="n">Address</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Address</span> <span class="p">{</span>
         <span class="n">City</span> <span class="p">=</span> <span class="s">&quot;Awesome Town&quot;</span><span class="p">,</span>
         <span class="n">State</span> <span class="p">=</span> <span class="s">&quot;TN&quot;</span><span class="p">,</span>
         <span class="n">Zip</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ZipCode</span><span class="p">()</span>
      <span class="p">},</span>
      <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Josh&quot;</span>
   <span class="p">};</span>

   <span class="kt">var</span> <span class="n">context</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ValidationContext</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
   <span class="kt">var</span> <span class="n">results</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;();</span>

   <span class="n">Validator</span><span class="p">.</span><span class="n">TryValidateObject</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

   <span class="n">PrintResults</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>

   <span class="n">Console</span><span class="p">.</span><span class="n">ReadKey</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">PrintResults</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;</span> <span class="n">results</span><span class="p">,</span> <span class="n">Int32</span> <span class="n">indentationLevel</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">validationResult</span> <span class="k">in</span> <span class="n">results</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">SetIndentation</span><span class="p">(</span><span class="n">indentationLevel</span><span class="p">);</span>

      <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">validationResult</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">);</span>
      <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">();</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">validationResult</span> <span class="k">is</span> <span class="n">CompositeValidationResult</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">PrintResults</span><span class="p">(((</span><span class="n">CompositeValidationResult</span><span class="p">)</span><span class="n">validationResult</span><span class="p">).</span><span class="n">Results</span><span class="p">,</span> <span class="n">indentationLevel</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">SetIndentation</span><span class="p">(</span><span class="kt">int</span> <span class="n">indentationLevel</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">Console</span><span class="p">.</span><span class="n">CursorLeft</span> <span class="p">=</span> <span class="n">indentationLevel</span> <span class="p">*</span> <span class="m">4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Running the above should result in the following output: </p>

<div class="separator" style="clear: both; text-align: center;"><a href="/img/RecursiveValidation.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="163" src="http://1.bp.blogspot.com/-mJLDCk0nY4Y/Toycmc6xuWI/AAAAAAAABF8/M99mCHMfxWs/s400/RecursiveValidation.png" width="366" /></a></div>

<p>Well, there you have it. A pretty simple solution that has the advantage of working alongside the Validation framework instead of against it!</p>

 </div>
 

<div class="footer">
    <h4>Share This Post</h4>

    <div class="socials-footer">
        <a class="btn btn-twitter" href="http://twitter.com/share?text=Recursive Validation Using DataAnnotations by @jwcarroll&url=http://www.technofattie.com/2011/10/05/recursive-validation-using-dataannotations.html" rel="nofollow"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="btn btn-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.technofattie.com/2011/10/05/recursive-validation-using-dataannotations.html" rel="nofollow"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fa fa-facebook"></i>
        </a>
        <a class="btn btn-google-plus" href="https://plus.google.com/share?url=http://www.technofattie.com/2011/10/05/recursive-validation-using-dataannotations.html" rel="nofollow"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
            <i class="fa fa-google-plus"></i>
        </a>
    </div>
</div>
</section>


<div class="comments">
 <div id="disqus_thread"></div>
 <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'technofattie'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>



        <footer class="footer">
          <p itemprop="author" itemscope itemtype="http://schema.org/Person">© <a href="/about/" itemprop="url"><span itemprop="name">Josh Carroll</span></a> 2014. All right reserved.</p>
          <div class="socials-footer">
          
            <a class="btn btn-twitter" href="https://twitter.com/jwcarroll" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          
            <a class="btn btn-linkedin" href="https://www.linkedin.com/in/jwcarroll" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
          
            <a class="btn btn-google-plus" href="https://www.google.com/+JoshCarrollW/posts" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          
            <a class="btn btn-github" href="https://github.com/jwcarroll" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
          
            <a class="btn btn-rss" href="/rss.xml" title="RSS">
              <i class="fa fa-rss"></i>
            </a>
          
          </div> <!-- /.socials-footer -->
        </footer> <!-- /footer -->

      </div>
    </div> <!-- /#primary -->

    <!-- Scripts -->
    <script src="/js/jquery-1.11.0.min.js"></script>
    <script src="/js/custom.js"></script>

    
    
    

  </body>
</html>