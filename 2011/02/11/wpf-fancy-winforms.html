<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming.">
    
    <meta name="author" content="Josh Carroll">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Google+ Authorship -->
    <link rel="author" href="https://www.google.com/+JoshCarrollW">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@jwcarroll">
    
    <meta name="twitter:description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming.">
    
    <meta name="twitter:title" content="WPF != Fancy Winforms - Techno Fattie">

    <title>WPF != Fancy Winforms - Techno Fattie</title>

    <!-- Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/bootstrap-social.css" rel="stylesheet">

    <!-- Styles -->
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/pygments/syntax.css" rel="stylesheet">

    <!-- HTML5 shiv for IE8 support -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->

    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47962022-1', 'technofattie.com');
    ga('send', 'pageview');

</script>
    
  </head>

  <body itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="url" content="http://www.technofattie.com" />
    <meta itemprop="description" content="Josh Carroll's Blog about Programming, Techno and Fatties... ok mostly just programming." />
    <div id="secondary" class="col-sm-3 sidebar" style="display: none;">
      <aside>

        <div class="about" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <h4>About <span itemprop="name">Josh Carroll</span></h4>
          <p itemprop="description">Computer geek, husband, father, theologian. I rock out web sites. I work for <span itemprop="worksFor" itemscope itemtype="http://schema.org/Organization"><a href="http://www.wintellect.com/" itemprop="url"><span itemprop="name">Wintellect</span></a></span>.</p>
        </div>

        <div class="socialmedia">
          <h4>Connect</h4>
          <div class="socials-sidebar">
          
            <a class="btn btn-twitter" href="https://twitter.com/jwcarroll" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          
            <a class="btn btn-linkedin" href="https://www.linkedin.com/in/jwcarroll" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
          
            <a class="btn btn-google-plus" href="https://www.google.com/+JoshCarrollW/posts" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          
            <a class="btn btn-github" href="https://github.com/jwcarroll" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
          
            <a class="btn btn-rss" href="/rss.xml" title="RSS">
              <i class="fa fa-rss"></i>
            </a>
          
          </div> <!-- /.socials-sidebar -->
        </div>
        
        <div class="tags">
          <h4>Tags</h4>
          <ul>
          
            <li>
              <a href="/tags/f%23.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">f#</span></a>
            </li>
          
            <li>
              <a href="/tags/dot-net.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dot-net</span></a>
            </li>
          
            <li>
              <a href="/tags/c%23.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">c#</span></a>
            </li>
          
            <li>
              <a href="/tags/data-sets.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">data-sets</span></a>
            </li>
          
            <li>
              <a href="/tags/commentary.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">commentary</span></a>
            </li>
          
            <li>
              <a href="/tags/qa.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">qa</span></a>
            </li>
          
            <li>
              <a href="/tags/tdd.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">tdd</span></a>
            </li>
          
            <li>
              <a href="/tags/unit-testing.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">unit-testing</span></a>
            </li>
          
            <li>
              <a href="/tags/security.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">security</span></a>
            </li>
          
            <li>
              <a href="/tags/wpf.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">wpf</span></a>
            </li>
          
            <li>
              <a href="/tags/validation.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">validation</span></a>
            </li>
          
            <li>
              <a href="/tags/programming.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">programming</span></a>
            </li>
          
            <li>
              <a href="/tags/sarcasm.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">sarcasm</span></a>
            </li>
          
            <li>
              <a href="/tags/stackoverflow.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">stackoverflow</span></a>
            </li>
          
            <li>
              <a href="/tags/dynamic.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dynamic</span></a>
            </li>
          
            <li>
              <a href="/tags/powershell.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">powershell</span></a>
            </li>
          
            <li>
              <a href="/tags/angular.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">angular</span></a>
            </li>
          
            <li>
              <a href="/tags/javascript.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">javascript</span></a>
            </li>
          
            <li>
              <a href="/tags/dependency-injection.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">dependency-injection</span></a>
            </li>
          
            <li>
              <a href="/tags/humor.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">humor</span></a>
            </li>
          
            <li>
              <a href="/tags/jekyll.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">jekyll</span></a>
            </li>
          
            <li>
              <a href="/tags/github.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">github</span></a>
            </li>
          
            <li>
              <a href="/tags/bootstrap.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">bootstrap</span></a>
            </li>
          
            <li>
              <a href="/tags/introspection.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">introspection</span></a>
            </li>
          
            <li>
              <a href="/tags/ng-transform.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">ng-transform</span></a>
            </li>
          
            <li>
              <a href="/tags/directives.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">directives</span></a>
            </li>
          
            <li>
              <a href="/tags/angular-tips.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">angular-tips</span></a>
            </li>
          
            <li>
              <a href="/tags/controller-as.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">controller-as</span></a>
            </li>
          
            <li>
              <a href="/tags/routing.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">routing</span></a>
            </li>
          
            <li>
              <a href="/tags/interviews.html" class="tag btn btn-tag btn-sm"><span itemprop="keywords">interviews</span></a>
            </li>
          
          </ul>
        </div>
        
        <div class="sidebar-links">
         <h4><a href="/archives/">Archives</a></h4>
        </div>
        
        
        <div>
            <h4>You Might Also Like:</h4>
            
            <h5>
               <a href="/2014/03/21/five-guidelines-for-avoiding-scope-soup-in-angular.html">5 Guidelines For Avoiding Scope Soup in Angular</a>
            </h5>
            
            <h5>
               <a href="/2011/09/23/solving-ayende%27s-tax-woes.html">Solving Ayende's Tax Woes</a>
            </h5>
            
            <h5>
               <a href="/2010/06/25/extending-moq-using-extension-methods.html">Extending Moq Using Extension Methods</a>
            </h5>
            
            <h5>
               <a href="/2014/09/03/the-best-javascript-interview-question.html">The Best JavaScript Interview Question</a>
            </h5>
            
            <h5>
               <a href="/2011/02/09/unit-testing-and-declarative-security-part-1.html">Unit Testing and Declarative Security, Part 1</a>
            </h5>
            
        </div>
        
        
      </aside>
    </div> <!-- /#secondary -->

    <div id="primary" class="col-sm-12">
      <div class="content">
        
        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              <a rel="home" title="Techno Fattie" href="/">
                <i class="fa fa-code"></i> <span itemprop="name">Techno Fattie</span>
              </a>
            </h1>            
          </hgroup>
          <div id="togglesidebar" class="btn btn-primary pull-right">
            <i class="fa fa-bars"></i>
          </div>
        </header> <!-- /header -->

        

<section class="post" itemscope itemtype="http://schema.org/BlogPosting">
 <header class="entry-header">
   <img class="entry-avatar" alt="Josh Carroll" height="52" width="52" src="http://www.gravatar.com/avatar/213ff080fa03648f0b71e4f4658a8046.png?s=52">
   <h1 class="entry-title"><a href="/2011/02/11/wpf-fancy-winforms.html" itemprop="url"><span itemprop="name">WPF != Fancy Winforms</span></a></h1>
   <p class="entry-meta">
     Posted on <a class="entry-date" href="/archives/#february-2011"><time itemprop="dateCreated" datetime="2011-02-11T00:00:00-05:00">11 February 2011</time></a> |
     By <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a itemprop="url" class="entry-author" href="/about/"><span itemprop="name">Josh Carroll</span></a></span>
     
     | Tags 
     
     <a href="/tags/c%23.html" class="btn btn-default btn-xs"><span itemprop="keywords">c#</span></a>
     
     <a href="/tags/dot-net.html" class="btn btn-default btn-xs"><span itemprop="keywords">dot-net</span></a>
     
     <a href="/tags/wpf.html" class="btn btn-default btn-xs"><span itemprop="keywords">wpf</span></a>
     
     
   </p>
 </header>
 <div class="entry-description" itemprop="articleBody">
   <p>I&#39;m a big fan of Stackoverflow, and I was just recently looking at this 
<a href="http://stackoverflow.com/questions/4965023/c-check-if-text-file-has-content">very simple question regarding changing button color.</a> 
On the surface it seems this would warrant a very simple answer, and indeed 
<a href="http://stackoverflow.com/questions/4965023/c-check-if-text-file-has-content/4965058#4965058">Chris&#39; Answer</a> 
was simple, straightforward and to the point.</p>

<p>However, it feels too much like how I would have done things back in the dark ages of WinForms.
There seems to be this misconception that WPF is just a fancier version of the old Win32 standby.
<em>(note I am not trying to imply this is what Chris thinks, it merely serves as a convenient backdrop for this post)</em></p>

<p>But WPF is not even a cousin, or distant relative of WinForms. If WPF saw WinForms in the hallway it would beat him up
and take his lunch money from him. Anyway, that is enough of a rant. On with what started out as my original answer to
the question, which turned into this epic post...</p>

<h3>Original Answer Starts Here:</h3>

<p>So Chris&#39; suggestion is pretty straightforward, and it is certainly easier to implement than what I am about to show you ;)
However, if you are going to venture into the world of WPF then you need to experience what it has to offer.</p>

<p>In my opinion the two biggest advantages in WPF are:</p>

<ol>
<li> <strong>The power and flexibility of the declarative model</strong></li>
<li> <strong>An incredibly rich data binding infrastructure</strong></li>
</ol>

<p>Granted those are immensely deep topics within WPF, but without at least gaining a minimal understanding of those topics,
it will be like driving a Lamborghini around in first gear all the time.</p>

<p>That being said, you can jump to the full solution <a href="#fullsolution">here</a>, copy and paste it into a
clean solution, and play with it for a second. I&#39;ll be waiting patiently here to give you a detailed explanation of what is going on.</p>

<p>Ready? Ok then, lets get going.</p>

<p>Lets start with the core logic of the application, your requirements are:</p>

<ol>
<li> <strong>Examine a file on disk</strong></li>
<li> <strong>Change the appearance of a button based on content length</strong></li>
<li> <strong>Update the appearance of the button when the file changes</strong></li>
</ol>

<p>Since the appearance of the button is presentation specific, we simply won&#39;t worry about that when implementing our
core logic. So what we really need to do is monitor the file for changes, and update a local variable with the
length of the file, if it exists.</p>

<p>This is a perfect job for a <a href="http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">FileSystemWatcher</span></a>.
The file watcher kicks off a thread in the background which utilizes some low level Win32 API&#39;s to monitor
events on the file system. We can tie into those events via the watcher, and handle them in our application asynchonously.</p>

<p>Creating a new watcher is pretty simple and all we really need to provide is the Path. Here I am simply using the
current location of the Executing Assembly for the base path. The second thing you see here is the Filter property.
This works just like the filter you would use in the command line.</p>

<div class="highlight"><pre><code class="csharp language-csharp" data-lang="csharp"><span class="k">private</span> <span class="n">FileSystemWatcher</span> <span class="n">_fileWatcher</span><span class="p">;</span>
<span class="k">private</span> <span class="k">const</span> <span class="n">String</span> <span class="n">FileToWatch</span> <span class="p">=</span> <span class="s">&quot;tempfile.txt&quot;</span><span class="p">;</span>

<span class="k">public</span> <span class="k">void</span> <span class="nf">InitializeFileWatcher</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">_fileWatcher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileSystemWatcher</span><span class="p">();</span>
    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Path</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetExecutingAssembly</span><span class="p">().</span><span class="n">Location</span><span class="p">);</span>
    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Filter</span> <span class="p">=</span> <span class="s">&quot;*.txt&quot;</span><span class="p">;</span>

    <span class="c1">//Snip...</span>
<span class="p">}</span>
</code></pre></div>

<p>Next we want to subscribe to the different types of events available, and tell the watcher to start doing it&#39;s thing.
In this case our event handler is just a thin wrapper around a simple method that does all the &quot;heavy&quot; lifting. Lastly
we call our <code>UpdateFileLength</code> method directly because we need to know what the status of the file is right now,
 without waiting on an event from our watcher.</p>

<div class="highlight"><pre><code class="csharp language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">void</span> <span class="nf">InitializeFileWatcher</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">//Snip...</span>

    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Created</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>
    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Changed</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>
    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Deleted</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>
    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Renamed</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>

    <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">EnableRaisingEvents</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

    <span class="n">UpdateFileLength</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">FileToWatch</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">UpdateFileLength</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Int64</span><span class="p">?</span> <span class="n">length</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span> <span class="p">==</span> <span class="n">FileToWatch</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">fi</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileInfo</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">fi</span><span class="p">.</span><span class="n">Exists</span><span class="p">)</span>
            <span class="n">length</span> <span class="p">=</span> <span class="n">fi</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">Dispatcher</span><span class="p">.</span><span class="n">Invoke</span><span class="p">((</span><span class="n">Action</span><span class="p">)(</span>
        <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">FileContentLength</span> <span class="p">=</span> <span class="n">length</span><span class="p">)</span>
    <span class="p">);</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">fileWatcher_Handler</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FileSystemEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UpdateFileLength</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">FullPath</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>The UpdateFileLength method is pretty simple. It checks to see if the file is the one we are looking for, extracts the
length if it exists, and updates a property on our MainWindow. Something that may seem a bit odd however,
is the use of the <a href="http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx"><code>Dispatcher</code></a> and an anonymous method in order to set that property.</p>

<p>Remember how I said that the <code>FileSystemWatcher</code> kicks off a background thread. Well, technically <code>UpdateFileLength</code>
could be getting executed from a different thread than the UI thread. And well... it&#39;s a big NO NO to access things
in the UI from another thread. Without going into a a lot of detail, the Dispatcher is responsible for scheduling
things to happen on the UI thread in WPF. Here we are ensuring that no matter what thread executes this method,
that that line will always be executed on the UI thread.</p>

<p>Ok, so the last little bit is our property we use to store the current length of the file we are monitoring, but it is no ordinary property.</p>

<div class="highlight"><pre><code class="csharp language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">DependencyProperty</span> <span class="n">FileContentLengthProperty</span> <span class="p">=</span> <span class="n">DependencyProperty</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span>
    <span class="s">&quot;FileContentLength&quot;</span><span class="p">,</span>
    <span class="k">typeof</span><span class="p">(</span><span class="n">Int64</span><span class="p">?),</span>
    <span class="k">typeof</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">UIPropertyMetadata</span><span class="p">(</span><span class="k">null</span><span class="p">));</span>

<span class="k">public</span> <span class="n">Int64</span><span class="p">?</span> <span class="n">FileContentLength</span>
<span class="p">{</span>
    <span class="k">get</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Int64</span><span class="p">?)</span><span class="n">GetValue</span><span class="p">(</span><span class="n">FileContentLengthProperty</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">set</span>
    <span class="p">{</span>
        <span class="n">SetValue</span><span class="p">(</span><span class="n">FileContentLengthProperty</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>What you are staring at here is known as a <a href="http://msdn.microsoft.com/en-us/library/ms752914.aspx"><code>DependencyProperty</code></a>,
and they are pretty foundational to how WPF works, so take some time to learn about them. For our purposes, just
know that what this provides for us is a way for WPF to monitor changes to our property, which allows for all sorts of fun stuff in the UI.</p>

<p>Now, on to the UI and where the real magic happens. Did you notice we didn&#39;t ever reference any buttons or set colors in
the code behind? That&#39;s because 99% of the time in WPF there is no need to. The declarative model we have in
<a href="http://msdn.microsoft.com/en-us/library/ms752059.aspx">XAML</a> combined with the rich data binding ecosystem
in WPF gives us the freedom to finally have true seperation of concerns between presentation and logic.</p>

<p>The first order of business is to set the
<a href="http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.datacontext.aspx"><code>DataContext</code></a> on the
Window itself so that we can access all of the properties defined in our code behind. Ok there is only one, but we still need it.</p>

<div class="highlight"><pre><code class="csharp language-csharp" data-lang="csharp"><span class="n">DataContext</span><span class="p">=</span><span class="s">&quot;{Binding RelativeSource={RelativeSource Self}}&quot;</span>
</code></pre></div>

<p>Next we need a button on our window. Ok, nothing special going on here, except that there is no content, no coloring,
just a Style property bound to some static resource called <code>&quot;FileBoundButton&quot;</code></p>

<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;button</span> <span class="na">Style=</span><span class="s">&quot;{StaticResource FileBoundButton}&quot;</span> <span class="na">Name=</span><span class="s">&quot;button1&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>

<p><a href="http://msdn.microsoft.com/en-us/library/ms745683.aspx">Styles in WPF are another big complex topic</a>, but
just know that this isn&#39;t anything like CSS. You can set virtually any property on an element via a style, and include
declarative triggers to change the appearance based on events, data, or even other elements. This is precisely how we
are going to achieve the visual affect you are after and then some!</p>

<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Style</span> <span class="na">x:Key=</span><span class="s">&quot;FileBoundButton&quot;</span> <span class="na">TargetType=</span><span class="s">&quot;ContentControl&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">&quot;Background&quot;</span> <span class="na">Value=</span><span class="s">&quot;Green&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">&quot;Content&quot;</span> <span class="na">Value=</span><span class="s">&quot;{Binding FileContentLength}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Style.Triggers&gt;</span>
        <span class="nt">&lt;Datatrigger</span> <span class="na">Binding=</span><span class="s">&quot;{Binding FileContentLength}&quot;</span> <span class="na">Value=</span><span class="s">&quot;{x:Null}&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;setter</span> <span class="na">Property=</span><span class="s">&quot;Background&quot;</span> <span class="na">Value=</span><span class="s">&quot;LightGray&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;setter</span> <span class="na">Property=</span><span class="s">&quot;Content&quot;</span> <span class="na">Value=</span><span class="s">&quot;No File!&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/DataTrigger&gt;</span>
        <span class="nt">&lt;Datatrigger</span> <span class="na">Binding=</span><span class="s">&quot;{Binding FileContentLength}&quot;</span> <span class="na">Value=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">&quot;Background&quot;</span> <span class="na">Value=</span><span class="s">&quot;Red&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/DataTrigger&gt;</span>
    <span class="nt">&lt;/Style.Triggers&gt;</span>
<span class="nt">&lt;/Style&gt;</span>
</code></pre></div>

<p>The style we are using is declared as a static resource on the window itself. You need a name if you want to be able to
refer to it later, and using a TargetType of ContentControl instead of a Button means we could reuse this style a lot
of different elements, not just a button.</p>

<p>We set the Background property to Green initially, and we also set the Content equal to the value of our
<code>FileContentLength</code> property. Then we make use of DataTriggers to alter those settings based on the value of
FileContentLength. The syntax of a DataTrigger can be a bit wonky at first, but if you were to spell it
out in pseudo-code it would sound something like this:</p>

<pre>
set the Background property to <span class="Apple-style-span" style="background-color: lime;">Green</span>
set the Content to DataContext.FileContentLength

<span class="Apple-style-span" style="color: blue;">IF</span> the value of DataContext.FileContentLength is <span class="Apple-style-span" style="color: red;">NULL</span>
    <span class="Apple-style-span" style="color: blue;">THEN</span> set the Background property to <span class="Apple-style-span" style="background-color: #cccccc;">LightGray</span> <span class="Apple-style-span" style="color: blue;">AND</span>
         set the Content to "No File!"
<span class="Apple-style-span" style="color: blue;">ELSE IF</span> the value of DataContext.FileContentLength is <span class="Apple-style-span" style="color: red;">0</span>
    <span class="Apple-style-span" style="color: blue;">THEN</span> set the Background property to <span class="Apple-style-span" style="background-color: red;">Red</span>
</pre>

<p>You might be wondering exactly <i>what</i> DataContext this is referring to. Essentially whatever framework element
this style happens to be applied to. Because we didn&#39;t set the Button&#39;s DataContext explicitely it will inherit the
DataContext of the Window. But be careful! Where the DataContext comes from isn&#39;t always apparent.</p>

<p>Now, if you put all this together and launch the app for the first time you should end up with a small
window with a gray button in it that says &quot;No File!&quot;</p>

<div style="text-align: center;"><img src="https://lh6.googleusercontent.com/_zrLYGpcNAqw/TVTfmg2jvoI/AAAAAAAAA18/PrNnn4ucwoc/s800/FileWatcher_NoFile.png" /></div>

<p>Without closing the program, navigate to the executing directory of your application &quot;[ProjectFolder]\bin\Debug&quot; and
create a new text file named &quot;tempfile.txt&quot; Now you should see the button change color to red and display a &quot;0&quot; since the file is empty.</p>

<div style="text-align: center;"><img src="https://lh4.googleusercontent.com/_zrLYGpcNAqw/TVTfmYRStiI/AAAAAAAAA10/pBNoBbSkEc0/s800/FileWatcher_EmptyFile.png" /></div>

<p>Open the newly created text file and write something in there. Save the file and again, watch as your button magically
changes before your eyes to green, and displaying &quot;N&quot; where N is the number of characters in your text file.</p>

<div style="text-align: center;"><img src="https://lh3.googleusercontent.com/_zrLYGpcNAqw/TVTfmQqJ5tI/AAAAAAAAA14/7jZ_skxgL4o/s800/FileWatcher_FileWithContent.png" /></div>

<p>If you actually made it through this whole thing, then you have hopefully been opened up to a whole new world of
possibilities by using WPF. Just remember that it is a very, very deep technology and you won&#39;t learn it over night.
Here are some resources to get you started on your journey though.</p>

<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/ms754130.aspx">The MSDN Walk Through.</a> Heavy reading, but worth it.</li>
<li><a href="http://www.wpftutorial.net/christian.php">Christian Moser&#39;s WPF Tutorial Site.</a> Lots of easy to digest samples.</li>
<li><a href="http://stackoverflow.com/questions/tagged/wpf">WPF Questions on Stackoverflow</a></li>
</ul>

<p><a name="fullsolution"></a></p>

<p><code>MainWindow.xaml</code>:</p>

<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">&quot;TechnoFattie.WPF.MainWindow&quot;</span> <span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
        <span class="na">xmlns:x=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
        <span class="na">xmlns:d=</span><span class="s">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span>
        <span class="na">xmlns:mc=</span><span class="s">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span> <span class="na">mc:Ignorable=</span><span class="s">&quot;d&quot;</span> <span class="na">Height=</span><span class="s">&quot;86&quot;</span> <span class="na">Width=</span><span class="s">&quot;174&quot;</span>
        <span class="na">Title=</span><span class="s">&quot;File Watcher Example&quot;</span> <span class="na">DataContext=</span><span class="s">&quot;{Binding RelativeSource={RelativeSource Self}}&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Window.Resources&gt;</span>
        <span class="nt">&lt;Style</span> <span class="na">x:Key=</span><span class="s">&quot;FileBoundButton&quot;</span> <span class="na">TargetType=</span><span class="s">&quot;Control&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;setter</span> <span class="na">Property=</span><span class="s">&quot;Background&quot;</span> <span class="na">Value=</span><span class="s">&quot;Green&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Style.Triggers&gt;</span>
            <span class="nt">&lt;DataTrigger</span> <span class="na">Binding=</span><span class="s">&quot;{Binding FileContentLength}&quot;</span> <span class="na">Value=</span><span class="s">&quot;{x:Null}&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;setter</span> <span class="na">Property=</span><span class="s">&quot;Background&quot;</span> <span class="na">Value=</span><span class="s">&quot;LightGray&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/DataTrigger&gt;</span>
              <span class="nt">&lt;DataTrigger</span> <span class="na">Binding=</span><span class="s">&quot;{Binding FileContentLength}&quot;</span> <span class="na">Value=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;setter</span> <span class="na">Property=</span><span class="s">&quot;Background&quot;</span> <span class="na">Value=</span><span class="s">&quot;Red&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/DataTrigger&gt;</span>
              <span class="nt">&lt;/Style.Triggers&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>
    <span class="nt">&lt;/Window.Resources&gt;</span>
    <span class="nt">&lt;Grid</span> <span class="na">x:Name=</span><span class="s">&quot;LayoutRoot&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">Content=</span><span class="s">&quot;{Binding FileContentLength}&quot;</span> <span class="na">Style=</span><span class="s">&quot;{StaticResource FileBoundButton}&quot;</span> <span class="na">Name=</span><span class="s">&quot;button1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</code></pre></div>

<p><code>MainWindow.xaml.cs</code>:</p>

<div class="highlight"><pre><code class="csharp language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">MainWindow</span> <span class="p">:</span> <span class="n">Window</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">FileSystemWatcher</span> <span class="n">_fileWatcher</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">const</span> <span class="n">String</span> <span class="n">FileToWatch</span> <span class="p">=</span> <span class="s">&quot;tempfile.txt&quot;</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">InitializeComponent</span><span class="p">();</span>

        <span class="n">InitializeFileWatcher</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">InitializeFileWatcher</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_fileWatcher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileSystemWatcher</span><span class="p">();</span>
        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Path</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetExecutingAssembly</span><span class="p">().</span><span class="n">Location</span><span class="p">);</span>
        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Filter</span> <span class="p">=</span> <span class="s">&quot;*.txt&quot;</span><span class="p">;</span>

        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Created</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>
        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Changed</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>
        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Deleted</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>
        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Renamed</span> <span class="p">+=</span> <span class="n">fileWatcher_Handler</span><span class="p">;</span>

        <span class="n">_fileWatcher</span><span class="p">.</span><span class="n">EnableRaisingEvents</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

        <span class="n">UpdateFileLength</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">_fileWatcher</span><span class="p">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">FileToWatch</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">UpdateFileLength</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Int64</span><span class="p">?</span> <span class="n">length</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span> <span class="p">==</span> <span class="n">FileToWatch</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">fi</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileInfo</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">fi</span><span class="p">.</span><span class="n">Exists</span><span class="p">)</span>
                <span class="n">length</span> <span class="p">=</span> <span class="n">fi</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">Dispatcher</span><span class="p">.</span><span class="n">Invoke</span><span class="p">((</span><span class="n">Action</span><span class="p">)(()</span> <span class="p">=&gt;</span> <span class="n">FileContentLength</span> <span class="p">=</span> <span class="n">length</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">fileWatcher_Handler</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FileSystemEventArgs</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">UpdateFileLength</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">FullPath</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">Int64</span><span class="p">?</span> <span class="n">FileContentLength</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">Int64</span><span class="p">?)</span><span class="n">GetValue</span><span class="p">(</span><span class="n">FileContentLengthProperty</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="n">SetValue</span><span class="p">(</span><span class="n">FileContentLengthProperty</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">DependencyProperty</span> <span class="n">FileContentLengthProperty</span> <span class="p">=</span> <span class="n">DependencyProperty</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span>
        <span class="s">&quot;FileContentLength&quot;</span><span class="p">,</span>
        <span class="k">typeof</span><span class="p">(</span><span class="n">Int64</span><span class="p">?),</span>
        <span class="k">typeof</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">),</span>
        <span class="k">new</span> <span class="nf">UIPropertyMetadata</span><span class="p">(</span><span class="k">null</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>

 </div>
 

<div class="footer">
    <h4>Share This Post</h4>

    <div class="socials-footer">
        <a class="btn btn-twitter" href="http://twitter.com/share?text=WPF != Fancy Winforms by @jwcarroll&url=http://www.technofattie.com/2011/02/11/wpf-fancy-winforms.html" rel="nofollow"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="btn btn-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.technofattie.com/2011/02/11/wpf-fancy-winforms.html" rel="nofollow"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fa fa-facebook"></i>
        </a>
        <a class="btn btn-google-plus" href="https://plus.google.com/share?url=http://www.technofattie.com/2011/02/11/wpf-fancy-winforms.html" rel="nofollow"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
            <i class="fa fa-google-plus"></i>
        </a>
    </div>
</div>
</section>

<div class="comments">
 <div id="disqus_thread"></div>
 <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'technofattie'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

        <footer class="footer">
          <p itemprop="author" itemscope itemtype="http://schema.org/Person">Â© <a href="/about/" itemprop="url"><span itemprop="name">Josh Carroll</span></a> 2014. All right reserved.</p>
          <div class="socials-footer">
          
            <a class="btn btn-twitter" href="https://twitter.com/jwcarroll" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          
            <a class="btn btn-linkedin" href="https://www.linkedin.com/in/jwcarroll" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
          
            <a class="btn btn-google-plus" href="https://www.google.com/+JoshCarrollW/posts" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          
            <a class="btn btn-github" href="https://github.com/jwcarroll" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
          
            <a class="btn btn-rss" href="/rss.xml" title="RSS">
              <i class="fa fa-rss"></i>
            </a>
          
          </div> <!-- /.socials-footer -->
        </footer> <!-- /footer -->

      </div>
    </div> <!-- /#primary -->

    <!-- Scripts -->
    <script src="/js/jquery-1.11.0.min.js"></script>
    <script src="/js/custom.js"></script>

    
    
    

  </body>
</html>